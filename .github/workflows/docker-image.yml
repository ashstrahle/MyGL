name: Docker Image CI

on:
  push:
    branches: [ "master" ]

jobs:
  build:
    runs-on: ubuntu18.04
    name: Build on ${{ matrix.distro }} ${{ matrix.arch }}
    # Run steps on a matrix of 3 arch/distro combinations
    strategy:
      matrix:
        include:
          - arch: aarch64
            distro: ubuntu18.04

    environment: production
    steps:
      - uses: actions/checkout@v3
      - uses: uraimo/run-on-arch-action@v3
        name: Build artifact
          id: build
          with:
            arch: ${{ matrix.arch }}
            distro: ${{ matrix.distro }}

        - name: Build the Docker image
          working-directory: ${{env.GITHUB_WORKSPACE}}
          run: .
            - sudo docker-compose build
            # - docker build . --file Dockerfile --tag MyGL-aarch64:latest
            - docker push ghcr.io/OWNER/MyGL-aarch64:latest